#!/usr/bin/env python

# Builds EPICS initialisation from input

import sys
import re

print '''/* Automatically generated file.
 * Do not edit or put under source control. */

static const struct i_record *EPICS_publish_data[] = {'''

pattern = re.compile(r'__PUBLISH_DATA__::<<<(.*?)>>>')
for line in sys.stdin:
    for match in pattern.findall(line):
        print '   ', match

print '''    NULL
};'''
